<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>City Selector</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.css"
  integrity="sha512-kJlvECunwXftkPwyvHbclArO8wszgBGisiLeuDFwNM8ws+wKIw0sv1os3ClWZOcrEB2eRXULYUsm8OVRGJKwGA=="
  crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }

    body {
      padding: 20px;
    }

    #openModalBtn {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }

    #openModalBtn:hover {
      background-color: #45a049;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.52);
      z-index: 10;
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
      opacity: 1;
    }

    .modal-container {
      position: fixed;
      top: 0;
      left: -100%;
      width: 660px;
      height: 100%;
      background-color: white;
      padding: 32px;
      z-index: 11;
      transition: left 0.3s ease;
      overflow-y: auto;
    }

    .modal-container.active {
      left: 0;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 22px;
      font-weight: 500;
    }

    .close-btn {
      cursor: pointer;
      width: 24px;
      height: 24px;
      font-size: 24px;
      color: #666;
    }

    .modal-content {
      height: calc(100% - 60px);
      overflow-y: auto;
      position: relative;
    }

    .search-container {
      background-color: #EDEFF2;
      border-radius: 12px;
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      position: sticky;
      top: 0;
      z-index: 1;
      margin-bottom: 12px;
    }

    .search-icon {
      width: 20px;
      height: 20px;
    }

    .search-input {
      background-color: transparent;
      border: none;
      outline: none;
      width: 100%;
      font-size: 16px;
      font-weight: 500;
    }

    .location-list {
      width: 100%;
    }

    .location-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 8px;
      border-bottom: 1px solid #D7D7D9;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .location-item:hover {
      background-color: #F5F5F5;
    }

    .location-name {
      font-size: 16px;
    }

    .dostavka {
      margin-top: 20px;
      padding: 15px;
      background-color: #f0f0f0;
      border-radius: 8px;
    }

    .dostavka p {
      margin: 0;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <button id="openModalBtn">Shaharni tanlang</button>

  <div class="dostavka">
    <p id="selectedCity">Shahar tanlanmagan</p>
  </div>

  <div id="modalOverlay" class="modal-overlay"></div>

  <div id="modalContainer" class="modal-container">
    <div class="modal-header">
      <h2 class="modal-title">Shaharni tanlang</h2>
      <i id="closeModalBtn" class="ri-close-line close-btn"></i>
    </div>

    <div class="modal-content">
      <div class="search-container">
        <i class="ri-search-line search-icon"></i>
        <input id="searchInput" class="search-input" type="text" placeholder="Shaharni topish">
      </div>

      <div id="locationList" class="location-list">
        <!-- Locations will be inserted here by JavaScript -->
      </div>
    </div>
  </div>

  <script>
    // Mock city data (replace with your actual cityBase.js data)
    const locations = [
      "Toshkent", "Samarqand", "Buxoro", "Xiva", "Andijon",
      "Namangan", "Farg'ona", "Nukus", "Urganch", "Navoiy",
      "Jizzax", "Guliston", "Termiz", "Qarshi", "Angren",
      "Chirchiq", "Bekobod", "Qo'qon", "Marg'ilon", "Shahrisabz"
    ];

    // DOM elements
    const openModalBtn = document.getElementById('openModalBtn');
    const modalOverlay = document.getElementById('modalOverlay');
    const modalContainer = document.getElementById('modalContainer');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const searchInput = document.getElementById('searchInput');
    const locationList = document.getElementById('locationList');
    const selectedCity = document.getElementById('selectedCity');

    // Open modal function
    function openModal() {
      modalOverlay.style.display = 'block';
      modalContainer.style.display = 'block';
      setTimeout(() => {
        modalOverlay.classList.add('active');
        modalContainer.classList.add('active');
      }, 10);
      renderLocations(locations); // Render all locations initially
    }

    // Close modal function
    function closeModal() {
      modalOverlay.classList.remove('active');
      modalContainer.classList.remove('active');
      setTimeout(() => {
        modalOverlay.style.display = 'none';
        modalContainer.style.display = 'none';
      }, 300);
      searchInput.value = ''; // Clear search input
    }

    // Render locations function
    function renderLocations(cities) {
      locationList.innerHTML = ''; // Clear previous results

      if (cities.length === 0) {
        locationList.innerHTML = '<div class="location-item"><p class="location-name">Hech qanday shahar topilmadi</p></div>';
        return;
      }

      cities.forEach(city => {
        const locationItem = document.createElement('div');
        locationItem.className = 'location-item';

        const locationName = document.createElement('p');
        locationName.className = 'location-name';
        locationName.textContent = city;

        const arrowIcon = document.createElement('i');
        arrowIcon.className = 'ri-arrow-right-s-line';
        arrowIcon.style.fontSize = '20px';
        arrowIcon.style.color = '#666';

        locationItem.appendChild(locationName);
        locationItem.appendChild(arrowIcon);
        locationList.appendChild(locationItem);

        // Add click handler for each location
        locationItem.addEventListener('click', () => {
          selectedCity.textContent = city;
          closeModal();
        });
      });
    }

    // Filter locations based on search input
    function filterLocations() {
      const searchTerm = searchInput.value.toLowerCase();
      const filtered = locations.filter(city =>
        city.toLowerCase().startsWith(searchTerm)
      );
      renderLocations(filtered);
    }

    // Event listeners
    openModalBtn.addEventListener('click', openModal);
    closeModalBtn.addEventListener('click', closeModal);
    modalOverlay.addEventListener('click', closeModal);
    searchInput.addEventListener('input', filterLocations);

    // Close modal when pressing Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modalContainer.style.display === 'block') {
        closeModal();
      }
    });
  </script>
</body>
</html>